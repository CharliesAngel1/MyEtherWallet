{"version":3,"sources":["webpack:///./src/dapps/ens-manager-dapp/components/reverse/EnsReverseLookup.vue?4a2b","webpack:///./src/dapps/ens-manager-dapp/components/reverse/EnsReverseLookup.vue?ccd5","webpack:///./src/dapps/ens-manager-dapp/components/reverse/EnsReverseLookup.vue?92dc","webpack:///src/dapps/ens-manager-dapp/components/reverse/EnsReverseLookup.vue","webpack:///./src/dapps/ens-manager-dapp/components/reverse/EnsReverseLookup.vue?3af7","webpack:///./src/dapps/ens-manager-dapp/components/reverse/EnsReverseLookup.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","address","_v","_s","hasDomains","selectedDomain","domainListItems","error","on","setDomain","loading","disableRegister","nativeOn","$event","setReverseRecord","reverseRecordNames","_e","staticRenderFns","name","props","default","type","String","durationPick","ensManager","Object","data","ensLookupResults","fee","toBNSafe","selectedDomainAddr","permHandler","hasReverseRecordNames","computed","mapGetters","mapState","hasOwnProperty","value","balance","lt","length","watch","network","checkNetwork","setup","addr","web3","methods","_this$ensLookupResult","array","forEach","i","gas","getNameReverseData","gasPrice","currencyName","push","metainfo","networks","find","item","chainID","findDomainByAddress","ens","ENS","provider","eth","currentProvider","ensAddress","registry","PermanentNameModule","setDomainListItems","getReverseRecordNames","getAllNamesForAddress","domains","fetchDomains","isEmpty","map","nameHash","e","Toast","ERROR","chosenDomain","reverseRecord","setNameReverseRecord","err","errorHandler","reverse","component"],"mappings":"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","file":"js/chunk-f8764e3e.68be359c.js","sourcesContent":["export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./EnsReverseLookup.vue?vue&type=style&index=1&id=527e8ac8&prod&lang=scss&\"","export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./EnsReverseLookup.vue?vue&type=style&index=0&id=527e8ac8&prod&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('v-sheet',{staticClass:\"addressBlock d-flex justify-space-between align-center mb-7\",attrs:{\"color\":\"transparent\"}},[_c('mew-blockie',{attrs:{\"address\":_vm.address}}),_c('span',{staticClass:\"font-weight-heavy pr-15\"},[_vm._v(_vm._s(_vm.address))])],1),(!_vm.hasDomains)?_c('div',[_c('mew-alert',{staticClass:\"font-weight-light d-flex justify-space-between align-center mb-7 mt-7\",attrs:{\"hide-close-icon\":\"\"}},[_vm._v(\" No ENS names have their ETH Address records set to this address. Only ENS names that point to your Ethereum account can be set as your Primary ENS Name. \")])],1):_c('div',{staticClass:\"d-flex flex-column justify-space-between\"},[_c('div',{staticClass:\"mew-heading-2 mb-2\"},[_vm._v(\"Your Domains:\")]),_c('div',{staticClass:\"d-flex justify-space-between\"},[_c('mew-select',{staticClass:\"domain-dropdown\",attrs:{\"normal-dropdown\":\"\",\"value\":_vm.selectedDomain,\"filter-placeholder\":\"Search for Domain\",\"items\":_vm.domainListItems,\"error-messages\":_vm.selectedDomain.error},on:{\"input\":_vm.setDomain}}),_c('mew-button',{staticClass:\"set-button\",attrs:{\"title\":\"Register\",\"btn-size\":\"xlarge\",\"loading\":_vm.selectedDomain.loading,\"disabled\":_vm.disableRegister},nativeOn:{\"click\":function($event){return _vm.setReverseRecord(_vm.selectedDomain)}}})],1)]),(_vm.hasReverseRecordNames)?_c('div',[_c('div',{staticClass:\"mew-heading-2 mb-2\"},[_vm._v(\"Reverse Names:\")]),_c('div',{staticClass:\"d-flex justify-space-between\"},[_vm._v(\" \"+_vm._s(_vm.reverseRecordNames)+\" \")])]):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <v-sheet\n      class=\"addressBlock d-flex justify-space-between align-center mb-7\"\n      color=\"transparent\"\n    >\n      <mew-blockie :address=\"address\" />\n      <span class=\"font-weight-heavy pr-15\">{{ address }}</span>\n    </v-sheet>\n    <div v-if=\"!hasDomains\">\n      <mew-alert\n        hide-close-icon\n        class=\"font-weight-light d-flex justify-space-between align-center mb-7 mt-7\"\n      >\n        No ENS names have their ETH Address records set to this address. Only\n        ENS names that point to your Ethereum account can be set as your Primary\n        ENS Name.\n      </mew-alert>\n    </div>\n\n    <div v-else class=\"d-flex flex-column justify-space-between\">\n      <div class=\"mew-heading-2 mb-2\">Your Domains:</div>\n      <div class=\"d-flex justify-space-between\">\n        <mew-select\n          normal-dropdown\n          :value=\"selectedDomain\"\n          filter-placeholder=\"Search for Domain\"\n          :items=\"domainListItems\"\n          :error-messages=\"selectedDomain.error\"\n          class=\"domain-dropdown\"\n          @input=\"setDomain\"\n        >\n        </mew-select>\n        <mew-button\n          title=\"Register\"\n          class=\"set-button\"\n          btn-size=\"xlarge\"\n          :loading=\"selectedDomain.loading\"\n          :disabled=\"disableRegister\"\n          @click.native=\"setReverseRecord(selectedDomain)\"\n        />\n      </div>\n    </div>\n    <div v-if=\"hasReverseRecordNames\">\n      <div class=\"mew-heading-2 mb-2\">Reverse Names:</div>\n      <div class=\"d-flex justify-space-between\">\n        {{ reverseRecordNames }}\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { isEmpty } from 'lodash';\nimport ENS from '@ensdomains/ensjs';\nimport { mapGetters, mapState } from 'vuex';\nimport { Toast, ERROR } from '@/modules/toast/handler/handlerToast';\nimport PermanentNameModule from '../../handlers/handlerPermanentName';\nimport errorHandler from '@/modules/confirmation/handlers/errorHandler.js';\nimport metainfo from '../../metainfo.js';\nimport { toBNSafe } from '@/core/helpers/numberFormatHelper';\nexport default {\n  name: 'EnsReverseLookup',\n  props: {\n    address: {\n      default: '',\n      type: String\n    },\n    name: {\n      default: '',\n      type: String\n    },\n    durationPick: {\n      default: '',\n      type: String\n    },\n    ensManager: {\n      default: () => {},\n      type: Object\n    }\n  },\n  data() {\n    return {\n      ensLookupResults: null,\n      hasDomains: false,\n      selectedDomain: { loading: false, fee: toBNSafe(0), error: '' },\n      selectedDomainAddr: '',\n      permHandler: {},\n      hasReverseRecordNames: false,\n      reverseRecordNames: '',\n      domainListItems: []\n    };\n  },\n  computed: {\n    ...mapGetters('global', [\n      'network',\n      'gasPrice',\n      'gasPriceByType',\n      'getFiatValue'\n    ]),\n    ...mapGetters('external', ['fiatValue']),\n    ...mapState('global', ['gasPriceType']),\n    ...mapState('wallet', ['balance', 'web3', 'instance']),\n    disableRegister() {\n      if (\n        !this.selectedDomain.hasOwnProperty('address') ||\n        !this.selectedDomain.hasOwnProperty('name')\n      )\n        return true;\n      return (\n        (!this.selectedDomain.value &&\n          toBNSafe(this.balance).lt(this.selectedDomain.fee)) ||\n        this.selectedDomain.error.length > 0\n      );\n    }\n  },\n  watch: {\n    network() {\n      if (this.checkNetwork()) this.setup();\n    },\n    address(addr) {\n      if (this.checkNetwork() && addr) this.setup();\n    },\n    web3() {\n      if (this.checkNetwork()) this.setup();\n    }\n  },\n  async mounted() {\n    if (this.checkNetwork()) await this.setup();\n  },\n  methods: {\n    async setDomainListItems() {\n      const array = [];\n      this.ensLookupResults?.forEach(async i => {\n        i.loading = true;\n        i.fee = toBNSafe(0);\n        i.error = '';\n        try {\n          const gas = await this.permHandler.getNameReverseData(i.name);\n          i.fee = toBNSafe(gas * this.gasPrice);\n          if (toBNSafe(this.balance).lt(i.fee)) {\n            i.error = `Insufficient amount of ${this.network.type.currencyName}`;\n          }\n        } catch {\n          i.error = 'An error occurred while retrieving the domain information';\n          i.loading = false;\n          return array.push(i);\n        }\n        i.loading = false;\n        return array.push(i);\n      }) || [];\n      this.domainListItems = array;\n    },\n    checkNetwork() {\n      return metainfo.networks.find(\n        item => item.chainID === this.network.type.chainID\n      );\n    },\n    async setup() {\n      await this.findDomainByAddress();\n      const ens = this.network.type.ens\n        ? new ENS({\n            provider: this.web3.eth.currentProvider,\n            ensAddress: this.network.type.ens.registry\n          })\n        : null;\n      this.permHandler = new PermanentNameModule(\n        this.name,\n        this.address,\n        this.network,\n        this.web3,\n        ens,\n        this.durationPick\n      );\n      this.selectedDomain = { loading: false, fee: toBNSafe(0), error: '' };\n      await this.setDomainListItems();\n      this.getReverseRecordNames();\n    },\n    async fetchDomains() {\n      return await this.ensManager.getAllNamesForAddress(this.address);\n    },\n    async findDomainByAddress() {\n      try {\n        this.hasDomains = true;\n        const domains = await this.fetchDomains();\n        if (isEmpty(domains)) this.hasDomains = false;\n        this.ensLookupResults = domains.map(item => {\n          return {\n            name: item.name,\n            value: item.nameHash,\n            address: item.address\n          };\n        });\n      } catch (e) {\n        Toast(e, {}, ERROR);\n      }\n    },\n    setDomain(value) {\n      this.selectedDomain = value;\n      this.getReverseRecordNames(this.selectedDomainAddr);\n    },\n    async setReverseRecord(chosenDomain) {\n      try {\n        const reverseRecord = await this.permHandler.setNameReverseRecord(\n          chosenDomain.name\n        );\n        this.hasReverseRecordNames = true;\n        return reverseRecord;\n      } catch (e) {\n        const err = errorHandler(e);\n        if (err) Toast(err, {}, ERROR);\n      }\n    },\n    // async getReverseRecordNames() {\n    //   try {\n    //     const reverseRecordNames = await this.permHandler.getReverseNameRecords(\n    //       this.permHandler.nameHash\n    //     );\n    //     this.reverseRecordNames = reverseRecordNames;\n    //     return reverseRecordNames;\n    //   } catch (e) {\n    //     Toast(e, {}, ERROR);\n    //   }\n    // },\n    async getReverseRecordNames() {\n      try {\n        const ens = this.network.type.ens\n          ? new ENS(this.web3.currentProvider, this.network.type.ens.registry)\n          : null;\n        const reverse = ens.reverse(this.address);\n        this.reverseRecordNames = await reverse.name();\n        this.hasReverseRecordNames = true;\n      } catch (e) {\n        this.hasReverseRecordNames = false;\n      }\n    }\n  }\n};\n</script>\n<style lang=\"scss\" scoped>\n.set-button {\n  margin-left: 10px;\n}\n</style>\n\n<style lang=\"scss\">\n.domain-dropdown {\n  .v-input__slot {\n    height: 62px;\n  }\n}\n</style>\n","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./EnsReverseLookup.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./EnsReverseLookup.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./EnsReverseLookup.vue?vue&type=template&id=527e8ac8&scoped=true&\"\nimport script from \"./EnsReverseLookup.vue?vue&type=script&lang=js&\"\nexport * from \"./EnsReverseLookup.vue?vue&type=script&lang=js&\"\nimport style0 from \"./EnsReverseLookup.vue?vue&type=style&index=0&id=527e8ac8&prod&lang=scss&scoped=true&\"\nimport style1 from \"./EnsReverseLookup.vue?vue&type=style&index=1&id=527e8ac8&prod&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"527e8ac8\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}