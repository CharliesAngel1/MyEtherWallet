{"version":3,"sources":["webpack:///./src/dapps/staked-dapp/components/ExitPopup.vue?f0d1","webpack:///src/dapps/staked-dapp/components/ExitPopup.vue","webpack:///./src/dapps/staked-dapp/components/ExitPopup.vue?ed25","webpack:///./src/dapps/staked-dapp/components/ExitPopup.vue?5854","webpack:///./src/dapps/staked-dapp/components/ExitPopup.vue"],"names":["props","openExitModal","type","default","closeModal","selectedValidator","data","loadingButton","loadingSign","loadingStakedCall","exitFinished","computed","validatorUrl","message","intentToExit","validatorIndexes","address","leftBtn","text","color","method","btnMethod","btnTitle","withdrawalAddress","methods","modalClose","localReset","headers","body","challenge","signature","res","Toast","render","_vm","this","_h","$createElement","_c","_self","attrs","staticClass","_v","url","_s","validator_index","totalBalanceETH","_e","nativeOn","$event","apply","arguments","staticRenderFns","component"],"mappings":"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","file":"js/chunk-c7efed82.fa05588e.js","sourcesContent":["export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ExitPopup.vue?vue&type=style&index=0&id=b3d489e6&prod&lang=scss&scoped=true&\"","<template>\n  <mew-popup\n    max-width=\"690px\"\n    :show=\"openExitModal\"\n    :has-buttons=\"false\"\n    :has-body-content=\"true\"\n    title=\"Exit stake and withdraw\"\n    :left-btn=\"leftBtn\"\n  >\n    <div>\n      <div class=\"mb-5 mew-heading-4 text-center pa-4 success-container\">\n        You are exiting validator\n        <a\n          :href=\"selectedValidator.url\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n          >#{{ selectedValidator.validator_index }}</a\n        >\n        and will receive {{ selectedValidator.totalBalanceETH }} ETH to\n        <b>{{ withdrawalAddress }}</b>\n      </div>\n      <div class=\"mew-body mb-5\">\n        Your validator will be terminated and your staked ETH will be withdrawn.\n        After this is completed, you will no longer be earning staking rewards\n        on Ethereum. Any currently accumulated rewards will be automatically\n        deposited to your designated withdrawal address. The amount of time\n        until staking rewards and the full withdrawn stake appear in your wallet\n        depends on the Ethereum withdrawal queue and can not be influenced by\n        MEW.\n      </div>\n      <div class=\"pb-5\">\n        <div class=\"mew-caption\">\n          Sign message requesting Staked.us to exit your validator(s) from the\n          network:\n        </div>\n        <code>\n          {{ message }}\n        </code>\n      </div>\n      <div v-if=\"loadingButton || exitFinished\" class=\"pb-5\">\n        <div class=\"d-flex align-center pa-2 mb-2 loaders-container\">\n          <div class=\"mr-2\">\n            <v-progress-circular\n              v-if=\"loadingSign\"\n              indeterminate\n              color=\"primary\"\n              size=\"32\"\n              width=\"2\"\n            />\n            <v-icon\n              v-if=\"!loadingSign\"\n              size=\"24\"\n              color=\"greenPrimary\"\n              class=\"pa-1\"\n            >\n              mdi-checkbox-marked-circle\n            </v-icon>\n          </div>\n          <div>\n            {{ loadingSign ? 'Signing message' : 'Message signed' }}\n          </div>\n        </div>\n        <div class=\"d-flex align-center pa-2 loaders-container\">\n          <div class=\"mr-2\">\n            <v-progress-circular\n              v-if=\"loadingStakedCall\"\n              indeterminate\n              color=\"primary\"\n              size=\"32\"\n              width=\"2\"\n            />\n            <v-icon\n              v-if=\"!loadingStakedCall\"\n              size=\"24\"\n              color=\"greenPrimary\"\n              class=\"pa-1\"\n            >\n              mdi-checkbox-marked-circle\n            </v-icon>\n          </div>\n          <div>\n            {{\n              loadingStakedCall ? 'Sending to Staked.us' : 'Sent to Staked.us'\n            }}\n          </div>\n        </div>\n        <div v-if=\"!loadingSign && !loadingStakedCall\" class=\"mt-3\">\n          Successfully started exit & withdrawal process! Please check\n          <a\n            :href=\"`${validatorUrl}${selectedValidator.validator_index}`\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n            >#{{ selectedValidator.validator_index }}</a\n          >\n          for up to date status.\n        </div>\n      </div>\n      <div class=\"mb-2 text-center d-flex align-center justify-center\">\n        <mew-button\n          v-if=\"loadingSign && loadingStakedCall\"\n          :title=\"btnTitle\"\n          btn-size=\"xlarge\"\n          :loading=\"loadingButton\"\n          :disabled=\"loadingButton\"\n          @click.native=\"btnMethod\"\n        />\n        <mew-button\n          v-else\n          :title=\"btnTitle\"\n          btn-size=\"xlarge\"\n          :disabled=\"loadingSign || loadingStakedCall\"\n          @click.native=\"btnMethod\"\n        />\n      </div>\n    </div>\n  </mew-popup>\n</template>\n\n<script>\nimport { mapActions, mapGetters, mapState } from 'vuex';\nimport { isEmpty } from 'lodash';\nimport { toHex } from 'web3-utils';\n\nimport { ERROR, Toast } from '@/modules/toast/handler/handlerToast';\nimport networkConfig from '../handlers/configNetworkTypes';\nexport default {\n  props: {\n    openExitModal: {\n      type: Boolean,\n      default: false\n    },\n    closeModal: {\n      type: Function,\n      default: () => {}\n    },\n    selectedValidator: {\n      type: Object,\n      default: () => {}\n    }\n  },\n  data() {\n    return {\n      loadingButton: false,\n      loadingSign: true,\n      loadingStakedCall: true,\n      exitFinished: false\n    };\n  },\n  computed: {\n    ...mapState('wallet', ['instance', 'address']),\n    ...mapGetters('global', ['network']),\n    validatorUrl() {\n      return networkConfig.network[this.network.type.name].url;\n    },\n    /**\n     * returns the challenge to be signed by the user\n     */\n    message() {\n      return JSON.stringify({\n        intentToExit:\n          'I am signing this message and requesting that Staked exit the following validators from the network',\n        validatorIndexes: [this.selectedValidator.validator_index],\n        address: this.address\n      });\n    },\n    /**\n     * @returns object\n     * Returns the left button config for\n     * mew popup\n     */\n    leftBtn() {\n      return {\n        text: 'Cancel',\n        color: 'basic',\n        method: this.modalClose\n      };\n    },\n    btnMethod() {\n      if (this.loadingSign && this.loadingStakedCall) {\n        return this.signAndExit;\n      }\n      return this.modalClose;\n    },\n    btnTitle() {\n      if (this.loadingSign && this.loadingStakedCall) {\n        return 'Sign & Exit';\n      }\n      return 'Close';\n    },\n    withdrawalAddress() {\n      return isEmpty(this.selectedValidator)\n        ? '0x'\n        : `0x${this.selectedValidator.withdrawal_credentials.substring(\n            24,\n            this.selectedValidator.withdrawal_credentials.length\n          )}`;\n    }\n  },\n  methods: {\n    ...mapActions('stakedStore', ['addWithdrawalValidatorIndex']),\n    modalClose() {\n      this.localReset();\n      this.closeModal();\n    },\n    localReset() {\n      this.loadingButton = false;\n      this.loadingSign = true;\n      this.loadingStakedCall = true;\n      this.exitFinished = false;\n    },\n    async signAndExit() {\n      this.loadingButton = true;\n      try {\n        const signature = await this.instance.signMessage(\n          this.message,\n          this.address\n        );\n        const parsedSignature = toHex(signature);\n        this.loadingSign = false;\n        const challenge = Buffer.from(\n          '\\u{19}Ethereum Signed Message:\\n' +\n            this.message.length.toString() +\n            this.message\n        ).toString('hex');\n\n        const headerDomain =\n          this.network.type.name === 'ETH' ? 'mainnet' : 'staging';\n        const submitEndpoint = `https://${headerDomain}.mewwallet.dev/v2/stake/exit`;\n        await fetch(submitEndpoint, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({\n            address: this.address,\n            challenge: challenge.toString('hex'),\n            signature: parsedSignature\n          })\n        }).then(res => {\n          if (res.ok) {\n            this.loadingStakedCall = false;\n            this.loadingButton = false;\n            this.exitFinished = true;\n            this.addWithdrawalValidatorIndex(\n              this.selectedValidator.validator_index\n            );\n            return;\n          }\n          res.json().then(jsonres => {\n            Toast(jsonres.error ? jsonres.error : jsonres.msg, {}, ERROR);\n            this.localReset();\n          });\n        });\n      } catch (e) {\n        Toast(e, {}, ERROR);\n        this.localReset();\n      }\n    }\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.loaders-container {\n  border: 1px solid var(--v-greenPrimary-base);\n  border-radius: 5px;\n}\n.success-container {\n  @extend .loaders-container;\n  background-color: #f2fafa;\n}\n</style>\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('mew-popup',{attrs:{\"max-width\":\"690px\",\"show\":_vm.openExitModal,\"has-buttons\":false,\"has-body-content\":true,\"title\":\"Exit stake and withdraw\",\"left-btn\":_vm.leftBtn}},[_c('div',[_c('div',{staticClass:\"mb-5 mew-heading-4 text-center pa-4 success-container\"},[_vm._v(\" You are exiting validator \"),_c('a',{attrs:{\"href\":_vm.selectedValidator.url,\"target\":\"_blank\",\"rel\":\"noopener noreferrer\"}},[_vm._v(\"#\"+_vm._s(_vm.selectedValidator.validator_index))]),_vm._v(\" and will receive \"+_vm._s(_vm.selectedValidator.totalBalanceETH)+\" ETH to \"),_c('b',[_vm._v(_vm._s(_vm.withdrawalAddress))])]),_c('div',{staticClass:\"mew-body mb-5\"},[_vm._v(\" Your validator will be terminated and your staked ETH will be withdrawn. After this is completed, you will no longer be earning staking rewards on Ethereum. Any currently accumulated rewards will be automatically deposited to your designated withdrawal address. The amount of time until staking rewards and the full withdrawn stake appear in your wallet depends on the Ethereum withdrawal queue and can not be influenced by MEW. \")]),_c('div',{staticClass:\"pb-5\"},[_c('div',{staticClass:\"mew-caption\"},[_vm._v(\" Sign message requesting Staked.us to exit your validator(s) from the network: \")]),_c('code',[_vm._v(\" \"+_vm._s(_vm.message)+\" \")])]),(_vm.loadingButton || _vm.exitFinished)?_c('div',{staticClass:\"pb-5\"},[_c('div',{staticClass:\"d-flex align-center pa-2 mb-2 loaders-container\"},[_c('div',{staticClass:\"mr-2\"},[(_vm.loadingSign)?_c('v-progress-circular',{attrs:{\"indeterminate\":\"\",\"color\":\"primary\",\"size\":\"32\",\"width\":\"2\"}}):_vm._e(),(!_vm.loadingSign)?_c('v-icon',{staticClass:\"pa-1\",attrs:{\"size\":\"24\",\"color\":\"greenPrimary\"}},[_vm._v(\" mdi-checkbox-marked-circle \")]):_vm._e()],1),_c('div',[_vm._v(\" \"+_vm._s(_vm.loadingSign ? 'Signing message' : 'Message signed')+\" \")])]),_c('div',{staticClass:\"d-flex align-center pa-2 loaders-container\"},[_c('div',{staticClass:\"mr-2\"},[(_vm.loadingStakedCall)?_c('v-progress-circular',{attrs:{\"indeterminate\":\"\",\"color\":\"primary\",\"size\":\"32\",\"width\":\"2\"}}):_vm._e(),(!_vm.loadingStakedCall)?_c('v-icon',{staticClass:\"pa-1\",attrs:{\"size\":\"24\",\"color\":\"greenPrimary\"}},[_vm._v(\" mdi-checkbox-marked-circle \")]):_vm._e()],1),_c('div',[_vm._v(\" \"+_vm._s(_vm.loadingStakedCall ? 'Sending to Staked.us' : 'Sent to Staked.us')+\" \")])]),(!_vm.loadingSign && !_vm.loadingStakedCall)?_c('div',{staticClass:\"mt-3\"},[_vm._v(\" Successfully started exit & withdrawal process! Please check \"),_c('a',{attrs:{\"href\":(\"\" + _vm.validatorUrl + (_vm.selectedValidator.validator_index)),\"target\":\"_blank\",\"rel\":\"noopener noreferrer\"}},[_vm._v(\"#\"+_vm._s(_vm.selectedValidator.validator_index))]),_vm._v(\" for up to date status. \")]):_vm._e()]):_vm._e(),_c('div',{staticClass:\"mb-2 text-center d-flex align-center justify-center\"},[(_vm.loadingSign && _vm.loadingStakedCall)?_c('mew-button',{attrs:{\"title\":_vm.btnTitle,\"btn-size\":\"xlarge\",\"loading\":_vm.loadingButton,\"disabled\":_vm.loadingButton},nativeOn:{\"click\":function($event){return _vm.btnMethod.apply(null, arguments)}}}):_c('mew-button',{attrs:{\"title\":_vm.btnTitle,\"btn-size\":\"xlarge\",\"disabled\":_vm.loadingSign || _vm.loadingStakedCall},nativeOn:{\"click\":function($event){return _vm.btnMethod.apply(null, arguments)}}})],1)])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ExitPopup.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ExitPopup.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ExitPopup.vue?vue&type=template&id=b3d489e6&scoped=true&\"\nimport script from \"./ExitPopup.vue?vue&type=script&lang=js&\"\nexport * from \"./ExitPopup.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ExitPopup.vue?vue&type=style&index=0&id=b3d489e6&prod&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"b3d489e6\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}