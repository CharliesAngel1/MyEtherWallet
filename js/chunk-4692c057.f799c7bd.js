(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4692c057"],{"20bb":function(t,e,n){},"46c9":function(t,e,n){"use strict";n("20bb")},"8ff0":function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"module-nft-manager"},[n("mew-module",{staticClass:"text-center d-flex justify-end flex-grow-1 pt-6 mr-3",attrs:{"has-elevation":!0,"has-indicator":!0,title:"NFT Manager"},scopedSlots:t._u([{key:"moduleBody",fn:function(){return[n("div",{staticClass:"loader bgWalletBlockDark"},[t.loadingContracts&&!t.hasNoTokens?n("v-skeleton-loader",{attrs:{type:"table-heading,list-item-avatar-three-line, list-item-avatar-three-line, list-item-avatar-three-line"}}):t._e()],1),!t.loadingContracts&&0===t.contracts.length&&0===t.tabs.length||t.hasNoTokens?n("v-card",{staticClass:"d-flex align-center px-5 py-4",attrs:{flat:"",color:"bgWalletBlockDark","min-height":"94px"}},[n("v-card-text",{staticClass:"text-center"},[t._v(t._s(t.$t("nftManager.none-owned"))+" ")])],1):t._e(),!t.loadingContracts&&!t.onNftSend&&t.tabs.length>0&&!t.hasNoTokens?n("mew-tabs",{attrs:{items:t.tabs,"is-vertical":t.$vuetify.breakpoint.mdAndUp,"has-underline":t.$vuetify.breakpoint.smAndDown,"active-tab":t.activeTab},on:{onTab:t.onTab}},[t._l(t.contracts,(function(e,s){return n("template",{slot:"tabItemContent"+(s+1)},[n("div",{key:s,staticClass:"ml-5"},[n("div",{staticClass:"d-flex justify-space-between mt-3 mb-5"},[n("h5",{staticClass:"font-weight-bold"},[t._v(" "+t._s(t.selectedContract.name)+" ")]),n("div",[t._v("Total: "+t._s(t.selectedContract.total))])]),t.displayedTokens&&0===t.displayedTokens.length?n("div",[t._v(" Loading ... ")]):t._e(),t.displayedTokens&&0!==t.displayedTokens.length?n("div",[t._l(t.displayedTokens,(function(e,s){return n("div",{key:s,staticClass:"mb-3"},[n("nft-manager-details",{attrs:{loading:t.loadingTokens,"on-click":t.openNftSend,token:e}})],1)})),t.hasPages?n("div",{staticClass:"px-4 mt-3 d-flex align-center justify-end"},[n("v-pagination",{staticClass:"nft-pagination",attrs:{color:"expandHeader",length:t.totalPages,"prev-icon":"mdi-menu-left","next-icon":"mdi-menu-right"},on:{input:t.setPage},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1):t._e()],2):t._e()])])}))],2):t._e(),t.onNftSend?n("nft-manager-send",{attrs:{close:t.closeNftSend,nft:t.selectedNft,"nft-category":t.selectedContract.name,send:t.sendTx,disabled:!t.isValid,"enough-funds":t.enoughFunds,"show-balance-error":t.showBalanceError,"set-address":t.setAddress},on:{hasMinEth:t.hasMinEth}}):t._e()]},proxy:!0}])})],1)},a=[],r=(n("13d5"),n("14d9"),n("caad"),n("ac1f"),n("5319"),n("2f62")),i=n("5ba3"),o=n.n(i),d=n("9b88"),c=n("0b16"),l=n.n(c);const h=t=>t?(t=t.toString(),t.charAt(0).toUpperCase()+t.substr(1,t.length)):"",u=t=>{const e=l.a.parse(t).hostname,n=e.split(".");return n.length>2?h(`${n[1]}.${n[2]}`):h(n.join("."))};var p=u,y=n("db3a"),m=n("913e"),f=n("ac8e");n("d9e2");const g={url:"https://nft.mewapi.io",countPerPage:9,cryptoKittiesContract:"0x06012c8cf97bead5deae237070f9587f8e7a266d",mainnet:"ETH",api:"https://mainnet.mewwallet.dev"},b="https://partners.mewapi.io/nfts",T={1:b+"/owners?chains=ethereum&queried_wallet_balances=1&wallet_addresses=",137:b+"/owners?chains=polygon&queried_wallet_balances=1&wallet_addresses=",56:b+"/owners?chains=bsc&queried_wallet_balances=1&wallet_addresses="};var w=g;const k=[{constant:!1,inputs:[{name:"from",type:"address"},{name:"to",type:"address"},{name:"tokenId",type:"uint256"}],name:"safeTransferFrom",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_tokenId",type:"uint256"}],name:"transferFrom",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"_to",type:"address"},{name:"_tokenId",type:"uint256"}],name:"transfer",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"}];var N=k;const v=[{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"operator",type:"address"},{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!1,internalType:"uint256[]",name:"ids",type:"uint256[]"},{indexed:!1,internalType:"uint256[]",name:"values",type:"uint256[]"}],name:"TransferBatch",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"operator",type:"address"},{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!1,internalType:"uint256",name:"id",type:"uint256"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"TransferSingle",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"string",name:"value",type:"string"},{indexed:!0,internalType:"uint256",name:"id",type:"uint256"}],name:"URI",type:"event"},{inputs:[{internalType:"address",name:"account",type:"address"},{internalType:"uint256",name:"id",type:"uint256"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address[]",name:"accounts",type:"address[]"},{internalType:"uint256[]",name:"ids",type:"uint256[]"}],name:"balanceOfBatch",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"},{internalType:"address",name:"operator",type:"address"}],name:"isApprovedForAll",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256[]",name:"ids",type:"uint256[]"},{internalType:"uint256[]",name:"amounts",type:"uint256[]"},{internalType:"bytes",name:"data",type:"bytes"}],name:"safeBatchTransferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"id",type:"uint256"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"bytes",name:"data",type:"bytes"}],name:"safeTransferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"operator",type:"address"},{internalType:"bool",name:"approved",type:"bool"}],name:"setApprovalForAll",outputs:[],stateMutability:"nonpayable",type:"function"}];var P=v,_=n("901e"),x=n.n(_);class C{constructor({network:t,address:e,web3:n}){this.network=t,this.address=e,this.web3=n,this.countPerPage=w.countPerPage,this.currentPage=1}async getNfts(){try{let{result:t}=await fetch(`${T[this.network.type.chainID]}${this.address}`).then(t=>t.json()),e=t.nfts;while(t.next){const n=await fetch(t.next).then(t=>t.json());t=n.result,e=e.concat(t.nfts)}return e}catch(t){throw new Error(t)}}isValidAddress(t){return""!==t&&o.a.isAddress(t)}send(t,e,n){let s;return this.contract=new this.web3.eth.Contract(e.erc721?N:P),s=e.contract.includes(w.cryptoKittiesContract)?this.cryptoKittiesTransfer(t,e):e.erc721?this.safeTransferFrom(t,e):this.safeTransferFromRarible(t,e,1),s.from=this.address,void 0!==n&&(s.gasPrice=n),this.web3.eth.sendTransaction(s)}async getGasFees(t,e){let n;this.contract=new this.web3.eth.Contract(e.erc721?N:P),n=e.contract.toLowerCase().includes(w.cryptoKittiesContract)?this.cryptoKittiesTransfer(t,e):e.erc721?this.safeTransferFrom(t,e):this.safeTransferFromRarible(t,e,1),n.from=this.address;const s=this.web3.eth.estimateGas(n);return s}safeTransferFrom(t,e){return{to:e.contract,data:this.contract.methods.safeTransferFrom(this.address,t,e.token_id).encodeABI()}}safeTransferFromRarible(t,e,n,s="0x"){return{to:e.contract,data:this.contract.methods.safeTransferFrom(this.address,t,e.token_id,n,s).encodeABI()}}cryptoKittiesTransfer(t,e){return this.contract.options.address=e.contract,{to:e.contract,data:this.contract.methods.transfer(t,e.token_id).encodeABI()}}totalPages(t){return Math.ceil(new x.a(t).div(this.countPerPage).toNumber())}hasPages(t){return this.countPerPage<t}startIndex(){return this.currentPage*this.countPerPage-this.countPerPage}endIndex(t){const e=this.currentPage*this.countPerPage;return t>e?e:t}setCurrentPage(t){this.currentPage=t}goToFirstPage(){this.currentPage=1}}var A=n("2623");const F=21e3;var E={components:{NftManagerDetails:()=>n.e("chunk-ac492ee8").then(n.bind(null,"6ccc2")),NftManagerSend:()=>n.e("chunk-482f27de").then(n.bind(null,"b10c"))},data(){return{nft:{},activeTab:0,onNftSend:!1,hasNoTokens:!1,selectedNft:{},toAddress:"",selectedContract:{},gasFees:"0",enoughFunds:!1,showBalanceError:!1,localGasPrice:"0",loadingContracts:!0,loadingTokens:!0,nftApiResponse:[]}},computed:{...Object(r["e"])("wallet",["balance","web3","address"]),...Object(r["e"])("global",["network","gasPriceType"]),...Object(r["c"])("wallet",["balanceInETH","balanceInWei"]),...Object(r["c"])("global",["isEthNetwork","network","gasPrice","gasPriceByType"]),tabs(){return this.contracts.map(t=>{let e=`${t.name} (${t.count})`;return e.length>25&&(e=t.name.substring(0,20),e+=`... (${t.count})`),{name:e}})},tokens(){if(this.nftApiResponse.length>0){const t=this.nftApiResponse.filter(t=>t.contract_address.toLowerCase()===this.selectedContract.contract.toLowerCase());if(t)return t.map(t=>{const e=t.image_url?t.image_url:"";return{image:"https://img.mewapi.io/?image="+e,name:t.name||t.token_id,token_id:t.token_id,contract:t.contract_address,erc721:"ERC721"===t.contract.type}})}return[]},contracts(){return this.nftApiResponse.length>0?this.nftApiResponse.reduce((t,e)=>{const n=e.queried_wallet_balances[0].quantity,s=t.find(t=>t.contract===e.contract_address);return s?(s.count++,s.total+=n):t.push({contract:e.contract_address,count:1,total:n,name:e.contract.name||e.collection.name}),t},[]):[]},totalPages(){return this.nft.totalPages(this.selectedContract.count)},hasPages(){return this.nft.hasPages(this.selectedContract.count)},startIndex(){return this.nft.startIndex()},endIndex(){return this.nft.endIndex(this.selectedContract.count)},currentPage:{get(){return this.nft.currentPage},set(t){return t}},displayedTokens(){return this.tokens.slice(this.startIndex,this.endIndex)},isValid(){return this.nft.isValidAddress(this.toAddress)&&this.enoughFunds},supportedNetwork(){return this.supportedNetworks.includes(this.network.type.name)},supportedNetworks(){return[m["ETH"].name,m["MATIC"].name,m["BSC"].name]}},watch:{balanceInWei(){this.hasMinEth()},web3(){this.loadingContracts=!0,this.loadingTokens=!0,this.onNftSend=!1,this.address&&this.$router.push({name:y["b"].NFT_MANAGER.NAME}),this.supportedNetwork?this.setUpNFT():setTimeout(()=>{Object(d["e"])("NFT Manager not supported in network: "+this.network.type.name,{},d["f"]),this.nftApiResponse=[]},1e3)},address(){this.loadingContracts=!0,this.loadingTokens=!0,this.onNftSend=!1,this.address&&this.$router.push({name:y["b"].NFT_MANAGER.NAME}),this.setUpNFT()},contracts(t){t.length>0&&this.onTab(0)},async toAddress(t){if(Object(i["isAddress"])(t)&&this.enoughFunds)try{const e=this.gasPriceByType(this.gasPriceType);this.localGasPrice=e;const n=await this.nft.getGasFees(t,this.selectedNft),s=Object(f["h"])(n).mul(Object(f["h"])(e));this.gasFees=s.toString(),s.gte(Object(i["toBN"])(this.balanceInWei))?(this.enoughFunds=!1,this.showBalanceError=!0):(this.enoughFunds=!0,this.showBalanceError=!1)}catch(e){this.enoughFunds=!1,this.showBalanceError=!1,Object(d["e"])("Can't send NFT! Please double check if everything is correct",{},d["a"])}}},mounted(){this.setUpNFT()},methods:{setUpNFT(){this.supportedNetwork&&(this.nft=new C({network:this.network,address:this.address,web3:this.web3}),this.getNfts(),this.localGasPrice=this.gasPriceByType(this.gasPriceType),this.hasMinEth())},getNfts(){this.nft.getNfts().then(t=>{this.nftApiResponse=t,this.loadingContracts=!1,setTimeout(()=>{this.loadingTokens=!1},500)})},hasMinEth(){const t=this.localGasPrice;Object(i["toBN"])(this.balanceInWei).gt(Object(i["toBN"])(t).muln(F))?(this.enoughFunds=!0,this.showBalanceError=!1):(this.enoughFunds=!1,this.showBalanceError=!0)},onTab(t){this.activeTab=t,this.selectedContract=this.contracts[t],this.selectedContractHash=this.contracts[t].contract,this.nft.goToFirstPage()},openNftSend(t){t&&(this.selectedNft=t),this.onNftSend=!0,this.$router.push({name:y["b"].NFT_MANAGER_SEND.NAME})},closeNftSend(){this.onNftSend=!1,this.toAddress="",this.$router.push({name:y["b"].NFT_MANAGER.NAME})},async sendTx(){if(this.isValid)try{let t=void 0;"MATIC"===this.network.type.name&&(t="0x"+Object(i["toBN"])(this.localGasPrice).toString("hex")),this.nft.send(this.toAddress,this.selectedNft,t).then(t=>{this.updateValues(),this.enoughFunds=!0,this.toAddress="",this.closeNftSend(),Object(d["e"])("Cheers! Your transaction was mined. Check it in ",{title:""+p(this.network.type.blockExplorerTX),url:this.network.type.blockExplorerTX.replace("[[txHash]]",t.blockHash)},d["d"],5e3)}).catch(t=>{const e=Object(A["a"])(t.message);e&&Object(d["e"])(e,{},d["a"])})}catch(t){Object(d["e"])(t.message,{},d["f"])}},updateValues(){const t=this.tokens.findIndex(t=>t.token_id===this.selectedNft.token_id);this.tokens.splice(t,1),0===this.tokens.length&&1===this.contracts.length&&(this.hasNoTokens=!0),this.getNfts()},setAddress(t){this.toAddress="object"===typeof t&&t?t.address:t},setPage(t){this.nft.setCurrentPage(t)}}},M=E,j=(n("46c9"),n("2877")),I=Object(j["a"])(M,s,a,!1,null,"70540077",null);e["default"]=I.exports}}]);
//# sourceMappingURL=../sourcemaps/js/chunk-4692c057.f799c7bd.js.map