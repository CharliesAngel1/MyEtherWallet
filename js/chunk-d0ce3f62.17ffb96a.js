(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d0ce3f62"],{"4adc":function(e,t,n){},"8ff0":function(e,t,n){"use strict";n.r(t);var s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"module-nft-manager"},[n("mew-module",{staticClass:"text-center d-flex justify-end flex-grow-1 pt-6 mr-3",attrs:{"has-elevation":!0,"has-indicator":!0,title:"NFT Manager"},scopedSlots:e._u([{key:"moduleBody",fn:function(){return[n("div",{staticClass:"loader bgWalletBlockDark"},[e.loadingContracts&&!e.hasNoTokens?n("v-skeleton-loader",{attrs:{type:"table-heading,list-item-avatar-three-line, list-item-avatar-three-line, list-item-avatar-three-line"}}):e._e()],1),!e.loadingContracts&&0===e.contracts.length&&0===e.tabs.length||e.hasNoTokens?n("v-card",{staticClass:"d-flex align-center px-5 py-4",attrs:{flat:"",color:"bgWalletBlockDark","min-height":"94px"}},[n("v-card-text",{staticClass:"text-center"},[e._v(e._s(e.$t("nftManager.none-owned"))+" ")])],1):e._e(),!e.loadingContracts&&!e.onNftSend&&e.tabs.length>0&&!e.hasNoTokens?n("mew-tabs",{attrs:{items:e.tabs,"is-vertical":e.$vuetify.breakpoint.mdAndUp,"has-underline":e.$vuetify.breakpoint.smAndDown,"active-tab":e.activeTab},on:{onTab:e.onTab}},[e._l(e.contracts,(function(t,s){return n("template",{slot:"tabItemContent"+(s+1)},[n("div",{key:s,staticClass:"ml-5"},[n("div",{staticClass:"d-flex justify-space-between mt-3 mb-5"},[n("h5",{staticClass:"font-weight-bold"},[e._v(" "+e._s(e.selectedContract.name)+" ")]),n("div",[e._v("Total: "+e._s(e.selectedContract.total))])]),e.displayedTokens&&0===e.displayedTokens.length?n("div",[e._v(" Loading ... ")]):e._e(),e.displayedTokens&&0!==e.displayedTokens.length?n("div",[e._l(e.displayedTokens,(function(t,s){return n("div",{key:s,staticClass:"mb-3"},[n("nft-manager-details",{attrs:{loading:e.loadingTokens,"on-click":e.openNftSend,token:t}})],1)})),e.hasPages?n("div",{staticClass:"px-4 mt-3 d-flex align-center justify-end"},[n("v-pagination",{staticClass:"nft-pagination",attrs:{color:"expandHeader",length:e.totalPages,"prev-icon":"mdi-menu-left","next-icon":"mdi-menu-right"},on:{input:e.setPage},model:{value:e.currentPage,callback:function(t){e.currentPage=t},expression:"currentPage"}})],1):e._e()],2):e._e()])])}))],2):e._e(),e.onNftSend?n("nft-manager-send",{attrs:{close:e.closeNftSend,nft:e.selectedNft,"nft-category":e.selectedContract.name,send:e.sendTx,disabled:!e.isValid,"enough-funds":e.enoughFunds,"show-balance-error":e.showBalanceError,"set-address":e.setAddress},on:{hasMinEth:e.hasMinEth}}):e._e()]},proxy:!0}])})],1)},a=[],r=(n("13d5"),n("14d9"),n("caad"),n("ac1f"),n("5319"),n("2f62")),i=n("5ba3"),o=n.n(i),d=n("9b88"),c=n("0b16"),l=n.n(c);const h=e=>e?(e=e.toString(),e.charAt(0).toUpperCase()+e.substr(1,e.length)):"",u=e=>{const t=l.a.parse(e).hostname,n=t.split(".");return n.length>2?h(`${n[1]}.${n[2]}`):h(n.join("."))};var p=u,y=n("db3a"),m=n("913e"),f=n("ac8e");n("d9e2");const g={url:"https://nft.mewapi.io",countPerPage:9,cryptoKittiesContract:"0x06012c8cf97bead5deae237070f9587f8e7a266d",mainnet:"ETH",api:"https://mainnet.mewwallet.dev"},b="https://partners.mewapi.io/nfts",T={1:b+"/owners?chains=ethereum&queried_wallet_balances=1&wallet_addresses=",137:b+"/owners?chains=polygon&queried_wallet_balances=1&wallet_addresses=",56:b+"/owners?chains=bsc&queried_wallet_balances=1&wallet_addresses="};var w=g;const k=[{constant:!1,inputs:[{name:"from",type:"address"},{name:"to",type:"address"},{name:"tokenId",type:"uint256"}],name:"safeTransferFrom",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_tokenId",type:"uint256"}],name:"transferFrom",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"_to",type:"address"},{name:"_tokenId",type:"uint256"}],name:"transfer",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"}];var N=k;const v=[{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"operator",type:"address"},{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!1,internalType:"uint256[]",name:"ids",type:"uint256[]"},{indexed:!1,internalType:"uint256[]",name:"values",type:"uint256[]"}],name:"TransferBatch",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"operator",type:"address"},{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!1,internalType:"uint256",name:"id",type:"uint256"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"TransferSingle",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"string",name:"value",type:"string"},{indexed:!0,internalType:"uint256",name:"id",type:"uint256"}],name:"URI",type:"event"},{inputs:[{internalType:"address",name:"account",type:"address"},{internalType:"uint256",name:"id",type:"uint256"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address[]",name:"accounts",type:"address[]"},{internalType:"uint256[]",name:"ids",type:"uint256[]"}],name:"balanceOfBatch",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"},{internalType:"address",name:"operator",type:"address"}],name:"isApprovedForAll",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256[]",name:"ids",type:"uint256[]"},{internalType:"uint256[]",name:"amounts",type:"uint256[]"},{internalType:"bytes",name:"data",type:"bytes"}],name:"safeBatchTransferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"id",type:"uint256"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"bytes",name:"data",type:"bytes"}],name:"safeTransferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"operator",type:"address"},{internalType:"bool",name:"approved",type:"bool"}],name:"setApprovalForAll",outputs:[],stateMutability:"nonpayable",type:"function"}];var P=v,_=n("901e"),x=n.n(_);class C{constructor({network:e,address:t,web3:n}){this.network=e,this.address=t,this.web3=n,this.countPerPage=w.countPerPage,this.currentPage=1}async getNfts(){try{let{result:e}=await fetch(`${T[this.network.type.chainID]}${this.address}`).then(e=>e.json()),t=e.nfts;while(e.next){const n=await fetch(e.next).then(e=>e.json());e=n.result,t=t.concat(e.nfts)}return t}catch(e){throw new Error(e)}}isValidAddress(e){return""!==e&&o.a.isAddress(e)}send(e,t,n){let s;return this.contract=new this.web3.eth.Contract(t.erc721?N:P),s=t.contract.includes(w.cryptoKittiesContract)?this.cryptoKittiesTransfer(e,t):t.erc721?this.safeTransferFrom(e,t):this.safeTransferFromRarible(e,t,1),s.from=this.address,void 0!==n&&(s.gasPrice=n),this.web3.eth.sendTransaction(s)}async getGasFees(e,t){let n;this.contract=new this.web3.eth.Contract(t.erc721?N:P),n=t.contract.toLowerCase().includes(w.cryptoKittiesContract)?this.cryptoKittiesTransfer(e,t):t.erc721?this.safeTransferFrom(e,t):this.safeTransferFromRarible(e,t,1),n.from=this.address;const s=this.web3.eth.estimateGas(n);return s}safeTransferFrom(e,t){return{to:t.contract,data:this.contract.methods.safeTransferFrom(this.address,e,t.token_id).encodeABI()}}safeTransferFromRarible(e,t,n,s="0x"){return{to:t.contract,data:this.contract.methods.safeTransferFrom(this.address,e,t.token_id,n,s).encodeABI()}}cryptoKittiesTransfer(e,t){return this.contract.options.address=t.contract,{to:t.contract,data:this.contract.methods.transfer(e,t.token_id).encodeABI()}}totalPages(e){return Math.ceil(new x.a(e).div(this.countPerPage).toNumber())}hasPages(e){return this.countPerPage<e}startIndex(){return this.currentPage*this.countPerPage-this.countPerPage}endIndex(e){const t=this.currentPage*this.countPerPage;return e>t?t:e}setCurrentPage(e){this.currentPage=e}goToFirstPage(){this.currentPage=1}}var A=n("2623");const F=21e3;var M={components:{NftManagerDetails:()=>n.e("chunk-ac492ee8").then(n.bind(null,"6ccc2")),NftManagerSend:()=>n.e("chunk-482f27de").then(n.bind(null,"b10c"))},data(){return{nft:{},activeTab:0,onNftSend:!1,hasNoTokens:!1,selectedNft:{},toAddress:"",selectedContract:{},gasFees:"0",enoughFunds:!1,showBalanceError:!1,localGasPrice:"0",loadingContracts:!0,loadingTokens:!0,nftApiResponse:[]}},computed:{...Object(r["e"])("wallet",["balance","web3","address"]),...Object(r["e"])("global",["network","gasPriceType"]),...Object(r["c"])("wallet",["balanceInETH","balanceInWei"]),...Object(r["c"])("global",["isEthNetwork","network","gasPrice","gasPriceByType"]),tabs(){return this.contracts.map(e=>{let t=`${e.name} (${e.count})`;return t.length>25&&(t=e.name.substring(0,20),t+=`... (${e.count})`),{name:t}})},tokens(){if(this.nftApiResponse.length>0){const e=this.nftApiResponse.filter(e=>e.contract_address.toLowerCase()===this.selectedContract.contract.toLowerCase());if(e)return e.map(e=>{const t=e.image_url?e.image_url:"";return{image:"https://img.mewapi.io/?image="+t,name:e.name||e.token_id,token_id:e.token_id,contract:e.contract_address,erc721:"ERC721"===e.contract.type}})}return[]},contracts(){return this.nftApiResponse.length>0?this.nftApiResponse.reduce((e,t)=>{const n=t.queried_wallet_balances[0].quantity,s=e.find(e=>e.contract===t.contract_address);return s?(s.count++,s.total+=n):e.push({contract:t.contract_address,count:1,total:n,name:t.contract.name||t.collection.name}),e},[]):[]},totalPages(){return this.nft.totalPages(this.selectedContract.count)},hasPages(){return this.nft.hasPages(this.selectedContract.count)},startIndex(){return this.nft.startIndex()},endIndex(){return this.nft.endIndex(this.selectedContract.count)},currentPage:{get(){return this.nft.currentPage},set(e){return e}},displayedTokens(){return this.tokens.slice(this.startIndex,this.endIndex)},isValid(){return this.nft.isValidAddress(this.toAddress)&&this.enoughFunds},supportedNetwork(){return this.supportedNetworks.includes(this.network.type.name)},supportedNetworks(){return[m["ETH"].name,m["MATIC"].name,m["BSC"].name]}},watch:{balanceInWei(){this.hasMinEth()},web3(){this.loadingContracts=!0,this.loadingTokens=!0,this.onNftSend=!1,this.address&&this.$router.push({name:y["b"].NFT_MANAGER.NAME}),this.supportedNetwork?this.setUpNFT():setTimeout(()=>{Object(d["e"])("NFT Manager not supported in network: "+this.network.type.name,{},d["f"]),this.nftApiResponse=[]},1e3)},address(){this.loadingContracts=!0,this.loadingTokens=!0,this.onNftSend=!1,this.address&&this.$router.push({name:y["b"].NFT_MANAGER.NAME}),this.setUpNFT()},contracts(e){e.length>0&&this.onTab(0)},async toAddress(e){if(Object(i["isAddress"])(e))try{const t=this.gasPriceByType(this.gasPriceType);this.localGasPrice=t;const n=await this.nft.getGasFees(e,this.selectedNft),s=Object(f["h"])(n).mul(Object(f["h"])(t));this.gasFees=s.toString(),s.gte(Object(i["toBN"])(this.balanceInWei))?(this.enoughFunds=!1,this.showBalanceError=!0):(this.enoughFunds=!0,this.showBalanceError=!1)}catch(t){Object(d["e"])("Can't send NFT! Please double check if everything is correct",{},d["a"])}}},mounted(){this.setUpNFT()},methods:{setUpNFT(){this.supportedNetwork&&(this.nft=new C({network:this.network,address:this.address,web3:this.web3}),this.getNfts(),this.localGasPrice=this.gasPriceByType(this.gasPriceType),this.hasMinEth())},getNfts(){this.nft.getNfts().then(e=>{this.nftApiResponse=e,this.loadingContracts=!1,setTimeout(()=>{this.loadingTokens=!1},500)})},hasMinEth(){const e=this.localGasPrice;Object(i["toBN"])(this.balanceInWei).gt(Object(i["toBN"])(e).muln(F))?(this.enoughFunds=!0,this.showBalanceError=!1):(this.enoughFunds=!1,this.showBalanceError=!0)},onTab(e){this.activeTab=e,this.selectedContract=this.contracts[e],this.selectedContractHash=this.contracts[e].contract,this.nft.goToFirstPage()},openNftSend(e){e&&(this.selectedNft=e),this.onNftSend=!0,this.$router.push({name:y["b"].NFT_MANAGER_SEND.NAME})},closeNftSend(){this.onNftSend=!1,this.toAddress="",this.$router.push({name:y["b"].NFT_MANAGER.NAME})},async sendTx(){if(this.isValid)try{let e=void 0;"MATIC"===this.network.type.name&&(e="0x"+Object(i["toBN"])(this.localGasPrice).toString("hex")),this.nft.send(this.toAddress,this.selectedNft,e).then(e=>{this.updateValues(),this.enoughFunds=!0,this.toAddress="",this.closeNftSend(),Object(d["e"])("Cheers! Your transaction was mined. Check it in ",{title:""+p(this.network.type.blockExplorerTX),url:this.network.type.blockExplorerTX.replace("[[txHash]]",e.blockHash)},d["d"],5e3)}).catch(e=>{const t=Object(A["a"])(e.message);t&&Object(d["e"])(t,{},d["a"])})}catch(e){Object(d["e"])(e.message,{},d["f"])}},updateValues(){const e=this.tokens.findIndex(e=>e.token_id===this.selectedNft.token_id);this.tokens.splice(e,1),0===this.tokens.length&&1===this.contracts.length&&(this.hasNoTokens=!0),this.getNfts()},setAddress(e){this.toAddress="object"===typeof e&&e?e.address:e},setPage(e){this.nft.setCurrentPage(e)}}},E=M,j=(n("e586"),n("2877")),I=Object(j["a"])(E,s,a,!1,null,"ae2ed630",null);t["default"]=I.exports},e586:function(e,t,n){"use strict";n("4adc")}}]);
//# sourceMappingURL=../sourcemaps/js/chunk-d0ce3f62.17ffb96a.js.map